
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>../src/lowrisc_ip_aes_0.6/rtl/aes_core.sv Cov: 99% </h3>
<pre style="margin:0; padding:0 ">// Copyright lowRISC contributors.</pre>
<pre style="margin:0; padding:0 ">// Licensed under the Apache License, Version 2.0, see LICENSE for details.</pre>
<pre style="margin:0; padding:0 ">// SPDX-License-Identifier: Apache-2.0</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// AES core implementation</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">`include "prim_assert.sv"</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">module aes_core #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter bit AES192Enable = 1,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter     SBoxImpl     = "lut"</pre>
<pre style="margin:0; padding:0 ">) (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                     clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                     rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // PRNG Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                     prng_data_req_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                     prng_data_ack_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [63:0]              prng_data_i,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                     prng_reseed_req_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                     prng_reseed_ack_i,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Bus Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  aes_reg_pkg::aes_reg2hw_t reg2hw,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output aes_reg_pkg::aes_hw2reg_t hw2reg</pre>
<pre style="margin:0; padding:0 ">);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  import aes_reg_pkg::*;</pre>
<pre style="margin:0; padding:0 ">  import aes_pkg::*;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 ctrl_qe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 ctrl_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_op_e              aes_op_d, aes_op_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_mode_e            aes_mode;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_mode_e            aes_mode_d, aes_mode_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  ciph_op_e             cipher_op;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_len_e             key_len;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_len_e             key_len_d, key_len_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 manual_operation_q;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] state_in;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  si_sel_e              state_in_sel;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] add_state_in;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  add_si_sel_e          add_state_in_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] state_init;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] state_done;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_init;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0]       key_init_qe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_init_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_init_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0]       key_init_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_init_sel_e        key_init_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] iv;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0]       iv_qe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][15:0] iv_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][15:0] iv_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0]       iv_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  iv_sel_e              iv_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][15:0] ctr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0]       ctr_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 ctr_incr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 ctr_ready;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] data_in_prev_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] data_in_prev_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 data_in_prev_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  dip_sel_e             data_in_prev_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] data_in;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0]       data_in_qe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 data_in_we;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] add_state_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  add_so_sel_e          add_state_out_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] data_out_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] data_out_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 data_out_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic           [3:0] data_out_re;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_in_valid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_in_ready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_out_valid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_out_ready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_crypt;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_crypt_busy;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_dec_key_gen;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_dec_key_gen_busy;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_key_clear;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_key_clear_busy;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_data_out_clear;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 cipher_data_out_clear_busy;</pre>
<pre id="id99" style="background-color: #FFB6C1; margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Unused signals</pre>
<pre style="margin:0; padding:0 ">  logic     [3:0][31:0] unused_data_out_q;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  ////////////</pre>
<pre style="margin:0; padding:0 ">  // Inputs //</pre>
<pre style="margin:0; padding:0 ">  ////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_init_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<8; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_init[i]    = reg2hw.key[i].q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_init_qe[i] = reg2hw.key[i].qe;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : iv_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      iv[i]    = reg2hw.iv[i].q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      iv_qe[i] = reg2hw.iv[i].qe;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : data_in_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      data_in[i]    = reg2hw.data_in[i].q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      data_in_qe[i] = reg2hw.data_in[i].qe;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : data_out_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="margin:0; padding:0 ">      // data_out is actually hwo, but we need hrw for hwre</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      unused_data_out_q[i] = reg2hw.data_out[i].q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      data_out_re[i]       = reg2hw.data_out[i].re;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign aes_op_d = aes_op_e'(reg2hw.ctrl.operation.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign aes_mode = aes_mode_e'(reg2hw.ctrl.mode.q);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : mode_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (aes_mode)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_ECB: aes_mode_d = AES_ECB;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_CBC: aes_mode_d = AES_CBC;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_CTR: aes_mode_d = AES_CTR;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default: aes_mode_d = AES_ECB; // unsupported values are mapped to AES_ECB</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign key_len = key_len_e'(reg2hw.ctrl.key_len.q);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_len_get</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (key_len)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_128: key_len_d = AES_128;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_256: key_len_d = AES_256;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      AES_192: key_len_d = AES192Enable ? AES_192 : AES_128;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default: key_len_d = AES_128; // unsupported values are mapped to AES_128</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign ctrl_qe = reg2hw.ctrl.operation.qe & reg2hw.ctrl.mode.qe & reg2hw.ctrl.key_len.qe &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      reg2hw.ctrl.manual_operation.qe;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  //////////////////////</pre>
<pre style="margin:0; padding:0 ">  // Key, IV and Data //</pre>
<pre style="margin:0; padding:0 ">  //////////////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Initial Key registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_init_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (key_init_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_INIT_INPUT: key_init_d = key_init;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_INIT_CLEAR: key_init_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:        key_init_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : key_init_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<8; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      if (key_init_we[i]) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        key_init_q[i] <= key_init_d[i];</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // IV registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : iv_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (iv_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      IV_INPUT:        iv_d = iv;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      IV_DATA_OUT:     iv_d = data_out_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      IV_DATA_IN_PREV: iv_d = data_in_prev_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      IV_CTR:          iv_d = ctr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      IV_CLEAR:        iv_d = {prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:         iv_d = {prng_data_i, prng_data_i};</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : iv_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<8; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      if (iv_we[i]) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        iv_q[i] <= iv_d[i];</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Previous input data register</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : data_in_prev_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (data_in_prev_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      DIP_DATA_IN: data_in_prev_d = data_in;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      DIP_CLEAR:   data_in_prev_d = {prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:     data_in_prev_d = {prng_data_i, prng_data_i};</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : data_in_prev_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (data_in_prev_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      data_in_prev_q <= data_in_prev_d;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 ">  // Counter //</pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_ctr aes_ctr (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i    ( clk_i     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni   ( rst_ni    ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .incr_i   ( ctr_incr  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ready_o  ( ctr_ready ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_i    ( iv_q      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_o    ( ctr       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_we_o ( ctr_we    )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////////</pre>
<pre style="margin:0; padding:0 ">  // Cipher Core //</pre>
<pre style="margin:0; padding:0 ">  /////////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Cipher core operation</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign cipher_op = (aes_mode_q == AES_ECB && aes_op_q == AES_ENC) ? CIPH_FWD :</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                     (aes_mode_q == AES_ECB && aes_op_q == AES_DEC) ? CIPH_INV :</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                     (aes_mode_q == AES_CBC && aes_op_q == AES_ENC) ? CIPH_FWD :</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                     (aes_mode_q == AES_CBC && aes_op_q == AES_DEC) ? CIPH_INV :</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                     (aes_mode_q == AES_CTR)                        ? CIPH_FWD : CIPH_FWD;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Mux for state input</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : state_in_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (state_in_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      SI_ZERO: state_in = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      SI_DATA: state_in = aes_transpose(data_in);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default: state_in = '0;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Mux for addition to state input</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : add_state_in_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (add_state_in_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_SI_ZERO: add_state_in = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_SI_IV:   add_state_in = aes_transpose(iv_q);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:     add_state_in = '0;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Convert input data to state format (every input data word contains one state column)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign state_init = state_in ^ add_state_in;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Cipher core</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_cipher_core #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AES192Enable ( AES192Enable ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SBoxImpl     ( SBoxImpl     )</pre>
<pre id="id269" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) aes_cipher_core (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i            ( clk_i                      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni           ( rst_ni                     ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_valid_i       ( cipher_in_valid            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ready_o       ( cipher_in_ready            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_valid_o      ( cipher_out_valid           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ready_i      ( cipher_out_ready           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i             ( cipher_op                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_len_i        ( key_len_q                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .crypt_i          ( cipher_crypt               ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .crypt_o          ( cipher_crypt_busy          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dec_key_gen_i    ( cipher_dec_key_gen         ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dec_key_gen_o    ( cipher_dec_key_gen_busy    ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_i      ( cipher_key_clear           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_o      ( cipher_key_clear_busy      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_i ( cipher_data_out_clear      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_o ( cipher_data_out_clear_busy ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_data_i      ( prng_data_i                ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .state_init_i     ( state_init                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_init_i       ( key_init_q                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .state_o          ( state_done                 )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Mux for addition to state output</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : add_state_out_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (add_state_out_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_SO_ZERO: add_state_out = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_SO_IV:   add_state_out = aes_transpose(iv_q);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_SO_DIP:  add_state_out = aes_transpose(data_in_prev_q);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:     add_state_out = '0;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Convert output state to output data format (every state column corresponds to one output word)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign data_out_d = aes_transpose(state_done ^ add_state_out);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 ">  // Control //</pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Control</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_control aes_control (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i                   ( clk_i                            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                  ( rst_ni                           ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i                    ( aes_op_q                         ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .mode_i                  ( aes_mode_q                       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_op_i             ( cipher_op                        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .manual_operation_i      ( manual_operation_q               ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .start_i                 ( reg2hw.trigger.start.q           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_i             ( reg2hw.trigger.key_clear.q       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_clear_i              ( reg2hw.trigger.iv_clear.q        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_clear_i         ( reg2hw.trigger.data_in_clear.q   ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_i        ( reg2hw.trigger.data_out_clear.q  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_reseed_i           ( reg2hw.trigger.prng_reseed.q     ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_init_qe_i           ( key_init_qe                      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_qe_i                 ( iv_qe                            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_qe_i            ( data_in_qe                       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_re_i           ( data_out_re                      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_we_o            ( data_in_we                       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_we_o           ( data_out_we                      ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_prev_sel_o      ( data_in_prev_sel                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_prev_we_o       ( data_in_prev_we                  ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .state_in_sel_o          ( state_in_sel                     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .add_state_in_sel_o      ( add_state_in_sel                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .add_state_out_sel_o     ( add_state_out_sel                ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_incr_o              ( ctr_incr                         ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_ready_i             ( ctr_ready                        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ctr_we_i                ( ctr_we                           ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_in_valid_o       ( cipher_in_valid                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_in_ready_i       ( cipher_in_ready                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_out_valid_i      ( cipher_out_valid                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_out_ready_o      ( cipher_out_ready                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_crypt_o          ( cipher_crypt                     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_crypt_i          ( cipher_crypt_busy                ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_dec_key_gen_o    ( cipher_dec_key_gen               ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_dec_key_gen_i    ( cipher_dec_key_gen_busy          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_key_clear_o      ( cipher_key_clear                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_key_clear_i      ( cipher_key_clear_busy            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_data_out_clear_o ( cipher_data_out_clear            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cipher_data_out_clear_i ( cipher_data_out_clear_busy       ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_init_sel_o          ( key_init_sel                     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_init_we_o           ( key_init_we                      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_sel_o                ( iv_sel                           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_we_o                 ( iv_we                            ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_data_req_o         ( prng_data_req_o                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_data_ack_i         ( prng_data_ack_i                  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_reseed_req_o       ( prng_reseed_req_o                ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_reseed_ack_i       ( prng_reseed_ack_i                ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .start_o                 ( hw2reg.trigger.start.d           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .start_we_o              ( hw2reg.trigger.start.de          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_o             ( hw2reg.trigger.key_clear.d       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_we_o          ( hw2reg.trigger.key_clear.de      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_clear_o              ( hw2reg.trigger.iv_clear.d        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .iv_clear_we_o           ( hw2reg.trigger.iv_clear.de       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_clear_o         ( hw2reg.trigger.data_in_clear.d   ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_in_clear_we_o      ( hw2reg.trigger.data_in_clear.de  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_o        ( hw2reg.trigger.data_out_clear.d  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_we_o     ( hw2reg.trigger.data_out_clear.de ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_reseed_o           ( hw2reg.trigger.prng_reseed.d     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prng_reseed_we_o        ( hw2reg.trigger.prng_reseed.de    ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .output_valid_o          ( hw2reg.status.output_valid.d     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .output_valid_we_o       ( hw2reg.status.output_valid.de    ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .input_ready_o           ( hw2reg.status.input_ready.d      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .input_ready_we_o        ( hw2reg.status.input_ready.de     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .idle_o                  ( hw2reg.status.idle.d             ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .idle_we_o               ( hw2reg.status.idle.de            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .stall_o                 ( hw2reg.status.stall.d            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .stall_we_o              ( hw2reg.status.stall.de           )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Input data register clear</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : data_in_reg_clear</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      hw2reg.data_in[i].d  = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      hw2reg.data_in[i].de = data_in_we;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Control register</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign ctrl_we = ctrl_qe & hw2reg.status.idle.d;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i or negedge rst_ni) begin : ctrl_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (!rst_ni) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      aes_op_q           <= AES_ENC;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      aes_mode_q         <= AES_ECB;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_len_q          <= AES_128;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      manual_operation_q <= '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    end else if (ctrl_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      aes_op_q           <= aes_op_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      aes_mode_q         <= aes_mode_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_len_q          <= key_len_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      manual_operation_q <= reg2hw.ctrl.manual_operation.q;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 ">  // Outputs //</pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : data_out_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (data_out_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      data_out_q <= data_out_d;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_reg_put</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<8; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      hw2reg.key[i].d  = key_init_q[i];</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : iv_reg_put</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      hw2reg.iv[i].d  = {iv_q[2*i+1], iv_q[2*i]};</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : data_out_put</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    for (int i=0; i<4; i++) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      hw2reg.data_out[i].d = data_out_q[i];</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.ctrl.mode.d    = {aes_mode_q};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.ctrl.key_len.d = {key_len_q};</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // These fields are actually hro. But software must be able observe the current value (rw).</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.ctrl.operation.d        = {aes_op_q};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.ctrl.manual_operation.d = manual_operation_q;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  ////////////////</pre>
<pre style="margin:0; padding:0 ">  // Assertions //</pre>
<pre style="margin:0; padding:0 ">  ////////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Selectors must be known/valid</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesKeyInitSelKnown, key_init_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT(AesIvSelValid, iv_sel inside {</pre>
<pre style="margin:0; padding:0 ">      IV_INPUT,</pre>
<pre style="margin:0; padding:0 ">      IV_DATA_OUT,</pre>
<pre style="margin:0; padding:0 ">      IV_DATA_IN_PREV,</pre>
<pre style="margin:0; padding:0 ">      IV_CTR,</pre>
<pre style="margin:0; padding:0 ">      IV_CLEAR</pre>
<pre style="margin:0; padding:0 ">      })</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesDataInPrevSelKnown, data_in_prev_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT(AesModeValid, aes_mode_q inside {</pre>
<pre style="margin:0; padding:0 ">      AES_ECB,</pre>
<pre style="margin:0; padding:0 ">      AES_CBC,</pre>
<pre style="margin:0; padding:0 ">      AES_CTR</pre>
<pre style="margin:0; padding:0 ">      })</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesOpKnown, aes_op_q)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesStateInSelKnown, state_in_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesAddStateInSelKnown, add_state_in_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT(AesAddStateOutSelValid, add_state_out_sel inside {</pre>
<pre style="margin:0; padding:0 ">      ADD_SO_ZERO,</pre>
<pre style="margin:0; padding:0 ">      ADD_SO_IV,</pre>
<pre style="margin:0; padding:0 ">      ADD_SO_DIP</pre>
<pre style="margin:0; padding:0 ">      })</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">endmodule</pre>
<pre style="margin:0; padding:0 "></pre>
</body>
</html>
