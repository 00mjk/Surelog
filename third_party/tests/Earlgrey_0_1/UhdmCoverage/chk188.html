
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>../src/lowrisc_ip_aes_0.6/rtl/aes_cipher_core.sv Cov: 95% </h3>
<pre style="margin:0; padding:0 ">// Copyright lowRISC contributors.</pre>
<pre style="margin:0; padding:0 ">// Licensed under the Apache License, Version 2.0, see LICENSE for details.</pre>
<pre style="margin:0; padding:0 ">// SPDX-License-Identifier: Apache-2.0</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// AES cipher core implementation</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// This module contains the AES cipher core including, state register, full key and decryption key</pre>
<pre style="margin:0; padding:0 ">// registers as well as key expand module and control unit.</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">`include "prim_assert.sv"</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">module aes_cipher_core #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter bit AES192Enable = 1,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter     SBoxImpl     = "lut"</pre>
<pre style="margin:0; padding:0 ">) (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Input handshake signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 in_valid_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 in_ready_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Output handshake signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 out_valid_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 out_ready_i,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Control and sync signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  aes_pkg::ciph_op_e    op_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  aes_pkg::key_len_e    key_len_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 crypt_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 crypt_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 dec_key_gen_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 dec_key_gen_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 key_clear_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 key_clear_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                 data_out_clear_i, // Re-use the cipher core muxes.</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                 data_out_clear_o,</pre>
<pre id="id38" style="background-color: #FFB6C1; margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Pseudo-random data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic          [63:0] prng_data_i,</pre>
<pre id="id41" style="background-color: #FFB6C1; margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // I/O data & initial key</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [3:0][3:0][7:0] state_init_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic     [7:0][31:0] key_init_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [3:0][3:0][7:0] state_o</pre>
<pre style="margin:0; padding:0 ">);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  import aes_pkg::*;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] state_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] state_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 state_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  state_sel_e           state_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] sub_bytes_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] shift_rows_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] mix_columns_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] add_round_key_in;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] add_round_key_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  add_rk_sel_e          add_round_key_in_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_full_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_full_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 key_full_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_full_sel_e        key_full_sel;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_dec_d;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_dec_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 key_dec_we;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_dec_sel_e         key_dec_sel;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [7:0][31:0] key_expand_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  ciph_op_e             key_expand_op;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 key_expand_step;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 key_expand_clear;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic           [3:0] key_expand_round;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  key_words_sel_e       key_words_sel;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic     [3:0][31:0] key_words;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] key_bytes;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] key_mix_columns_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0][3:0][7:0] round_key;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  round_key_sel_e       round_key_sel;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  //////////</pre>
<pre style="margin:0; padding:0 ">  // Data //</pre>
<pre style="margin:0; padding:0 ">  //////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // State registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : state_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (state_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      STATE_INIT:  state_d = state_init_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      STATE_ROUND: state_d = add_round_key_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      STATE_CLEAR: state_d = {prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:     state_d = {prng_data_i, prng_data_i};</pre>
<pre id="id94" style="background-color: #FFB6C1; margin:0; padding:0 ">    endcase</pre>
<pre id="id95" style="background-color: #FFB6C1; margin:0; padding:0 ">  end</pre>
<pre id="id96" style="background-color: #FFB6C1; margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : state_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (state_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      state_q <= state_d;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Cipher data path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_sub_bytes #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SBoxImpl ( SBoxImpl )</pre>
<pre id="id106" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) aes_sub_bytes (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i   ( op_i          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_i ( state_q       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_o ( sub_bytes_out )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_shift_rows aes_shift_rows (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i   ( op_i           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_i ( sub_bytes_out  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_o ( shift_rows_out )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_mix_columns aes_mix_columns (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i   ( op_i            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_i ( shift_rows_out  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_o ( mix_columns_out )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : add_round_key_in_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (add_round_key_in_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_RK_INIT:  add_round_key_in = state_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_RK_ROUND: add_round_key_in = mix_columns_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ADD_RK_FINAL: add_round_key_in = shift_rows_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:      add_round_key_in = state_q;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign add_round_key_out = add_round_key_in ^ round_key;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////</pre>
<pre style="margin:0; padding:0 ">  // Key //</pre>
<pre style="margin:0; padding:0 ">  /////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Full Key registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_full_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (key_full_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_FULL_ENC_INIT: key_full_d = key_init_i;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_FULL_DEC_INIT: key_full_d = key_dec_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_FULL_ROUND:    key_full_d = key_expand_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_FULL_CLEAR:    key_full_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:           key_full_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : key_full_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (key_full_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_full_q <= key_full_d;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Decryption Key registers</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_dec_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (key_dec_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_DEC_EXPAND: key_dec_d = key_expand_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_DEC_CLEAR:  key_dec_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:        key_dec_d = {prng_data_i, prng_data_i, prng_data_i, prng_data_i};</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i) begin : key_dec_reg</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (key_dec_we) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      key_dec_q <= key_dec_d;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Key expand data path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_key_expand #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AES192Enable ( AES192Enable ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SBoxImpl     ( SBoxImpl     )</pre>
<pre id="id175" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) aes_key_expand (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i     ( clk_i            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni    ( rst_ni           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i      ( key_expand_op    ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .step_i    ( key_expand_step  ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clear_i   ( key_expand_clear ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .round_i   ( key_expand_round ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_len_i ( key_len_i        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_i     ( key_full_q       ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_o     ( key_expand_out   )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : key_words_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (key_words_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_WORDS_0123: key_words = key_full_q[3:0];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_WORDS_2345: key_words = AES192Enable ? key_full_q[5:2] : '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_WORDS_4567: key_words = key_full_q[7:4];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      KEY_WORDS_ZERO: key_words = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:        key_words = '0;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Convert words to bytes (every key word contains one column)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign key_bytes = aes_transpose(key_words);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_mix_columns aes_key_mix_columns (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i   ( CIPH_INV            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_i ( key_bytes           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_o ( key_mix_columns_out )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin : round_key_mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (round_key_sel)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ROUND_KEY_DIRECT: round_key = key_bytes;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      ROUND_KEY_MIXED:  round_key = key_mix_columns_out;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default:          round_key = key_bytes;</pre>
<pre style="margin:0; padding:0 ">    endcase</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 ">  // Control //</pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Control</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  aes_cipher_control aes_cipher_control (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i                  ( clk_i                ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                 ( rst_ni               ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_valid_i             ( in_valid_i           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ready_o             ( in_ready_o           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_valid_o            ( out_valid_o          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ready_i            ( out_ready_i          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_i                   ( op_i                 ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_len_i              ( key_len_i            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .crypt_i                ( crypt_i              ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .crypt_o                ( crypt_o              ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dec_key_gen_i          ( dec_key_gen_i        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dec_key_gen_o          ( dec_key_gen_o        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_i            ( key_clear_i          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_clear_o            ( key_clear_o          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_i       ( data_out_clear_i     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_out_clear_o       ( data_out_clear_o     ),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .state_sel_o            ( state_sel            ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .state_we_o             ( state_we             ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .add_rk_sel_o           ( add_round_key_in_sel ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_expand_op_o        ( key_expand_op        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_full_sel_o         ( key_full_sel         ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_full_we_o          ( key_full_we          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_dec_sel_o          ( key_dec_sel          ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_dec_we_o           ( key_dec_we           ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_expand_step_o      ( key_expand_step      ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_expand_clear_o     ( key_expand_clear     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_expand_round_o     ( key_expand_round     ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .key_words_sel_o        ( key_words_sel        ),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .round_key_sel_o        ( round_key_sel        )</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 ">  // Outputs //</pre>
<pre style="margin:0; padding:0 ">  /////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // The output of the last round is not stored into the state register but forwarded directly.</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign state_o = add_round_key_out;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  ////////////////</pre>
<pre style="margin:0; padding:0 ">  // Assertions //</pre>
<pre style="margin:0; padding:0 ">  ////////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Selectors must be known/valid</pre>
<pre style="margin:0; padding:0 ">  `ASSERT(AesStateSelValid, state_sel inside {</pre>
<pre style="margin:0; padding:0 ">      STATE_INIT,</pre>
<pre style="margin:0; padding:0 ">      STATE_ROUND,</pre>
<pre style="margin:0; padding:0 ">      STATE_CLEAR</pre>
<pre style="margin:0; padding:0 ">      })</pre>
<pre style="margin:0; padding:0 ">  `ASSERT(AesAddRKSelValid, add_round_key_in_sel inside {</pre>
<pre style="margin:0; padding:0 ">      ADD_RK_INIT,</pre>
<pre style="margin:0; padding:0 ">      ADD_RK_ROUND,</pre>
<pre style="margin:0; padding:0 ">      ADD_RK_FINAL</pre>
<pre style="margin:0; padding:0 ">      })</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesKeyFullSelKnown, key_full_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesKeyDecSelKnown, key_dec_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesKeyWordsSelKnown, key_words_sel)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(AesRoundKeySelKnown, round_key_sel)</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">endmodule</pre>
<pre style="margin:0; padding:0 "></pre>
</body>
</html>
