
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>hw/ip/flash_ctrl/rtl/flash_ctrl.sv Cov: 97% </h3>
<pre style="margin:0; padding:0 ">// Copyright lowRISC contributors.</pre>
<pre style="margin:0; padding:0 ">// Licensed under the Apache License, Version 2.0, see LICENSE for details.</pre>
<pre style="margin:0; padding:0 ">// SPDX-License-Identifier: Apache-2.0</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// Faux Flash Controller Module</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">module flash_ctrl (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input        clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input        rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Bus Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input        tlul_pkg::tl_h2d_t tl_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output       tlul_pkg::tl_d2h_t tl_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Flash Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input        flash_ctrl_pkg::flash_m2c_t flash_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output       flash_ctrl_pkg::flash_c2m_t flash_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Interrupts</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_prog_empty_o, // Program fifo is empty</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_prog_lvl_o,   // Program fifo is empty</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_rd_full_o,    // Read fifo is full</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_rd_lvl_o,     // Read fifo is full</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_op_done_o,    // Requested flash operation (wr/erase) done</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic intr_op_error_o    // Requested flash operation (wr/erase) done</pre>
<pre style="margin:0; padding:0 ">);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  import flash_ctrl_pkg::*;</pre>
<pre style="margin:0; padding:0 ">  import flash_ctrl_reg_pkg::*;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int NumBanks = top_pkg::FLASH_BANKS;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int PagesPerBank = top_pkg::FLASH_PAGES_PER_BANK;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int WordsPerPage = top_pkg::FLASH_WORDS_PER_PAGE;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int BankW = top_pkg::FLASH_BKW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int PageW = top_pkg::FLASH_PGW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int WordW = top_pkg::FLASH_WDW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int AllPagesW = BankW + PageW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int AddrW = top_pkg::FLASH_AW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int DataWidth = top_pkg::FLASH_DW;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int DataBitWidth = $clog2(DataWidth/8);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int EraseBitWidth = $bits(flash_erase_op_e);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int FifoDepth = 16;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int FifoDepthW = $clog2(FifoDepth+1);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  localparam int MpRegions = 8;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_ctrl_reg2hw_t reg2hw;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_ctrl_hw2reg_t hw2reg;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  tlul_pkg::tl_h2d_t tl_fifo_h2d [2];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  tlul_pkg::tl_d2h_t tl_fifo_d2h [2];</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Register module</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_ctrl_reg_top u_reg (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_win_o (tl_fifo_h2d),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_win_i (tl_fifo_d2h),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .reg2hw,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .hw2reg,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .devmode_i  (1'b1)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // FIFO Connections</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 prog_fifo_wready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 prog_fifo_rvalid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 prog_fifo_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 prog_fifo_wen;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 prog_fifo_ren;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] prog_fifo_wdata;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] prog_fifo_rdata;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [FifoDepthW-1:0] prog_fifo_depth;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 rd_fifo_wready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 rd_fifo_rvalid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 rd_fifo_wen;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic                 rd_fifo_ren;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] rd_fifo_wdata;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] rd_fifo_rdata;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [FifoDepthW-1:0] rd_fifo_depth;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Program Control Connections</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic prog_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic prog_flash_ovfl;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [AddrW-1:0] prog_flash_addr;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Read Control Connections</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rd_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rd_flash_ovfl;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [AddrW-1:0] rd_flash_addr;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Erase Control Connections</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic erase_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [AddrW-1:0] erase_flash_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [EraseBitWidth-1:0] erase_flash_type;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Done / Error signaling from ctrl modules</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [2:0] ctrl_done, ctrl_err;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Flash Memory Protection Connections</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic flash_rd_done, flash_prog_done, flash_erase_done;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic flash_error;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [AddrW-1:0] flash_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] flash_prog_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataWidth-1:0] flash_rd_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic init_busy;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rd_op;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic prog_op;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic erase_op;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [AllPagesW-1:0] err_page;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [BankW-1:0] err_bank;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign rd_op = reg2hw.control.op.q == FlashRead;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign prog_op = reg2hw.control.op.q == FlashProg;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign erase_op = reg2hw.control.op.q == FlashErase;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Program FIFO</pre>
<pre style="margin:0; padding:0 ">  // Since the program and read FIFOs are never used at the same time, it should really be one</pre>
<pre style="margin:0; padding:0 ">  // FIFO with muxed inputs and outputs.  This should be addressed once the flash integration</pre>
<pre style="margin:0; padding:0 ">  // strategy has been identified</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  tlul_adapter_sram #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SramAw(1),         //address unused</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SramDw(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ByteAccess(0),     //flash may not support byte access</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ErrOnRead(1)       //reads not supported</pre>
<pre id="id134" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_to_prog_fifo (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_i       (tl_fifo_h2d[0]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_o       (tl_fifo_d2h[0]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_o      (prog_fifo_req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .gnt_i      (prog_fifo_wready),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .we_o       (prog_fifo_wen),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .addr_o     (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wmask_o    (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wdata_o    (prog_fifo_wdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rdata_i    (DataWidth'(0)),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rvalid_i   (1'b0),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rerror_i   (2'b0)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  prim_fifo_sync #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .Width(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .Depth(FifoDepth)</pre>
<pre id="id153" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_prog_fifo (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clr_i  (reg2hw.control.fifo_rst.q),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wvalid (prog_fifo_req & prog_fifo_wen),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wready (prog_fifo_wready),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wdata  (prog_fifo_wdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .depth  (prog_fifo_depth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rvalid (prog_fifo_rvalid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rready (prog_fifo_ren),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rdata  (prog_fifo_rdata)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Program handler is consumer of prog_fifo</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_prog_ctrl #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .DataW(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AddrW(AddrW)</pre>
<pre id="id170" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_flash_prog_ctrl (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // Software Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_start_i     (reg2hw.control.start.q & prog_op),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_num_words_i (reg2hw.control.num.q),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_done_o      (ctrl_done[0]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_err_o       (ctrl_err[0]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_addr_i      (reg2hw.addr.q[DataBitWidth +: AddrW]),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // FIFO Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_i         (prog_fifo_rdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_rdy_i     (prog_fifo_rvalid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_rd_o      (prog_fifo_ren),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // Flash Macro Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_req_o    (prog_flash_req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_addr_o   (prog_flash_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_ovfl_o   (prog_flash_ovfl),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_data_o   (flash_prog_data),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_done_i   (flash_prog_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_error_i  (flash_error)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Read FIFO</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic adapter_rvalid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i or negedge rst_ni) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (!rst_ni) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      adapter_rvalid <= 1'b0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    end else begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      adapter_rvalid <= rd_fifo_ren && rd_fifo_rvalid;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  tlul_adapter_sram #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SramAw(1),         //address unused</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .SramDw(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ByteAccess(0),     //flash may not support byte access</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .ErrOnWrite(1)      //writes not supported</pre>
<pre id="id210" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_to_rd_fifo (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_i       (tl_fifo_h2d[1]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tl_o       (tl_fifo_d2h[1]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_o      (rd_fifo_ren),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .gnt_i      (rd_fifo_rvalid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .we_o       (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .addr_o     (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wmask_o    (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wdata_o    (),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rdata_i    (rd_fifo_rdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rvalid_i   (adapter_rvalid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rerror_i   (2'b0)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  prim_fifo_sync #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .Width(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .Depth(FifoDepth)</pre>
<pre id="id229" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_rd_fifo (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clr_i  (reg2hw.control.fifo_rst.q),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wvalid (rd_fifo_wen),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wready (rd_fifo_wready),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .wdata  (rd_fifo_wdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .depth  (rd_fifo_depth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rvalid (rd_fifo_rvalid),</pre>
<pre style="margin:0; padding:0 ">    //adapter_rvalid is used here because adapter_sram does not accept data the same cycle.</pre>
<pre style="margin:0; padding:0 ">    //It expects an sram like interface where data arrives during the next cycle</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rready (adapter_rvalid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rdata  (rd_fifo_rdata)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Read handler is consumer of rd_fifo</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_rd_ctrl #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .DataW(DataWidth),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AddrW(AddrW)</pre>
<pre id="id248" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_flash_rd_ctrl (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // Software Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_start_i     (reg2hw.control.start.q & rd_op),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_num_words_i (reg2hw.control.num.q),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_done_o      (ctrl_done[1]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_err_o       (ctrl_err[1]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_addr_i      (reg2hw.addr.q[DataBitWidth +: AddrW]),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // FIFO Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_rdy_i     (rd_fifo_wready),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_o         (rd_fifo_wdata),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_wr_o      (rd_fifo_wen),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // Flash Macro Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_req_o    (rd_flash_req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_addr_o   (rd_flash_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_ovfl_o   (rd_flash_ovfl),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_data_i   (flash_rd_data),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_done_i   (flash_rd_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_error_i  (flash_error)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Erase handler does not consume fifo</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_erase_ctrl #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AddrW(AddrW),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .PagesPerBank(PagesPerBank),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .WordsPerPage(WordsPerPage),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .EraseBitWidth(EraseBitWidth)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  ) u_flash_erase_ctrl (</pre>
<pre style="margin:0; padding:0 ">    // Software Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_start_i     (reg2hw.control.start.q & erase_op),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_type_i      (reg2hw.control.erase_sel.q),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_done_o      (ctrl_done[2]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_err_o       (ctrl_err[2]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .op_addr_i      (reg2hw.addr.q[DataBitWidth +: AddrW]),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // Flash Macro Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_req_o    (erase_flash_req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_addr_o   (erase_flash_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_op_o     (erase_flash_type),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_done_i   (flash_erase_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .flash_error_i  (flash_error)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Final muxing to flash macro module</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_comb begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    unique case (reg2hw.control.op.q)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      FlashRead: begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_req = rd_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_addr = rd_flash_addr;</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      FlashProg: begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_req = prog_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_addr = prog_flash_addr;</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      FlashErase: begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_req = erase_flash_req;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_addr = erase_flash_addr;</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      default: begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_req = 1'b0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">        flash_addr  = '0;</pre>
<pre style="margin:0; padding:0 ">      end</pre>
<pre style="margin:0; padding:0 ">    endcase // unique case (flash_op_e'(reg2hw.control.op.q))</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // extra region is the default region</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_ctrl_reg2hw_mp_region_cfg_mreg_t [MpRegions:0] region_cfgs;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions-1:0] = reg2hw.mp_region_cfg[MpRegions-1:0];</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  //last region</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].base.q = '0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].size.q = {AllPagesW{1'b1}};</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].en.q = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].rd_en.q = reg2hw.default_region.rd_en.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].prog_en.q = reg2hw.default_region.prog_en.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign region_cfgs[MpRegions].erase_en.q = reg2hw.default_region.erase_en.q;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Flash memory protection</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  flash_mp #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .MpRegions(MpRegions),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .NumBanks(NumBanks),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .AllPagesW(AllPagesW)</pre>
<pre id="id335" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_flash_mp (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // sw configuration</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .region_cfgs_i(region_cfgs),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bank_cfgs_i(reg2hw.mp_bank_cfg),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // read / prog / erase controls</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_i(flash_req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_addr_i(flash_addr[WordW +: AllPagesW]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .addr_ovfl_i(rd_flash_ovfl | prog_flash_ovfl),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_bk_i(flash_addr[WordW + PageW +: BankW]),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rd_i(rd_op),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prog_i(prog_op),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pg_erase_i(erase_op & (erase_flash_type == PageErase)),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bk_erase_i(erase_op & (erase_flash_type == BankErase)),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rd_done_o(flash_rd_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prog_done_o(flash_prog_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .erase_done_o(flash_erase_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .error_o(flash_error),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .err_addr_o(err_page),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .err_bank_o(err_bank),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // flash phy interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .req_o(flash_o.req),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rd_o(flash_o.rd),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prog_o(flash_o.prog),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pg_erase_o(flash_o.pg_erase),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bk_erase_o(flash_o.bk_erase),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rd_done_i(flash_i.rd_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .prog_done_i(flash_i.prog_done),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .erase_done_i(flash_i.erase_done)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.op_status.done.d = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.op_status.done.de = |ctrl_done;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.op_status.err.d = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.op_status.err.de = |ctrl_err;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.rd_full.d = ~rd_fifo_wready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.rd_empty.d = ~rd_fifo_rvalid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.prog_full.d = ~prog_fifo_wready;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.prog_empty.d = ~prog_fifo_rvalid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.init_wip.d = init_busy;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.error_page.d = err_page;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.status.error_bank.d = err_bank;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.control.start.d = 1'b0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.control.start.de = |ctrl_done;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Flash Interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign flash_o.addr = flash_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign flash_o.prog_data = flash_prog_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign flash_rd_data = flash_i.rd_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign init_busy = flash_i.init_busy;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Interrupts</pre>
<pre style="margin:0; padding:0 ">  // Generate edge triggered signals for sources that are level</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] intr_src;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] intr_src_q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] intr_assert;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_src = { ~prog_fifo_rvalid,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                      reg2hw.fifo_lvl.prog.q == prog_fifo_depth,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                      ~rd_fifo_wready,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                      reg2hw.fifo_lvl.rd.q == rd_fifo_depth</pre>
<pre style="margin:0; padding:0 ">                    };</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  always_ff @(posedge clk_i or negedge rst_ni) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    if (!rst_ni) begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      intr_src_q <= 'h0;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    end else begin</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">      intr_src_q <= intr_src;</pre>
<pre style="margin:0; padding:0 ">    end</pre>
<pre style="margin:0; padding:0 ">  end</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_assert = ~intr_src_q & intr_src;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_prog_empty_o = reg2hw.intr_enable.prog_empty.q & reg2hw.intr_state.prog_empty.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_prog_lvl_o = reg2hw.intr_enable.prog_lvl.q & reg2hw.intr_state.prog_lvl.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_rd_full_o = reg2hw.intr_enable.rd_full.q & reg2hw.intr_state.rd_full.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_rd_lvl_o = reg2hw.intr_enable.rd_lvl.q & reg2hw.intr_state.rd_lvl.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_op_done_o = reg2hw.intr_enable.op_done.q & reg2hw.intr_state.op_done.q;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign intr_op_error_o = reg2hw.intr_enable.op_error.q & reg2hw.intr_state.op_error.q;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.prog_empty.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.prog_empty.de = intr_assert[3]  |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                           (reg2hw.intr_test.prog_empty.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                           reg2hw.intr_test.prog_empty.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.prog_lvl.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.prog_lvl.de = intr_assert[2]  |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                         (reg2hw.intr_test.prog_lvl.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                         reg2hw.intr_test.prog_lvl.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.rd_full.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.rd_full.de = intr_assert[1] |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        (reg2hw.intr_test.rd_full.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        reg2hw.intr_test.rd_full.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.rd_lvl.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.rd_lvl.de =  intr_assert[0] |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                       (reg2hw.intr_test.rd_lvl.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                       reg2hw.intr_test.rd_lvl.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.op_done.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.op_done.de = |ctrl_done  |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        (reg2hw.intr_test.op_done.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        reg2hw.intr_test.op_done.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.op_error.d  = 1'b1;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign hw2reg.intr_state.op_error.de = |ctrl_err  |</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        (reg2hw.intr_test.op_error.qe  &</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">                                        reg2hw.intr_test.op_error.q);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Unused bits</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [DataBitWidth-1:0] unused_byte_sel;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [31-AddrW:0] unused_higher_addr_bits;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [31:0] unused_scratch;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Unused signals</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign unused_byte_sel = reg2hw.addr.q[DataBitWidth-1:0];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign unused_higher_addr_bits = reg2hw.addr.q[31:AddrW];</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign unused_scratch = reg2hw.scratch;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // Assertions</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(TlDValidKnownO_A,       tl_o.d_valid,       clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(TlAReadyKnownO_A,       tl_o.a_ready,       clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(FlashKnownO_A,          {flash_o.req, flash_o.rd, flash_o.prog, flash_o.pg_erase,</pre>
<pre style="margin:0; padding:0 ">                                         flash_o.bk_erase}, clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_VALID_DATA(FlashAddrKnown_A,  flash_o.req, flash_o.addr, clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_VALID_DATA(FlashProgKnown_A,  flash_o.prog & flash_o.req, flash_o.prog_data,</pre>
<pre style="margin:0; padding:0 ">                                        clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrProgEmptyKnownO_A,  intr_prog_empty_o,  clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrProgLvlKnownO_A,    intr_prog_lvl_o,    clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrProgRdFullKnownO_A, intr_rd_full_o,     clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrRdLvlKnownO_A,      intr_rd_lvl_o,      clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrOpDoneKnownO_A,     intr_op_done_o,     clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 ">  `ASSERT_KNOWN(IntrOpErrorKnownO_A,    intr_op_error_o,    clk_i, !rst_ni)</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">endmodule</pre>
<pre style="margin:0; padding:0 "></pre>
</body>
</html>
