
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>hw/ip/usb_fs_nb_pe/rtl/usb_fs_nb_pe.sv Cov: 98% </h3>
<pre style="margin:0; padding:0 ">// Copyright lowRISC contributors.</pre>
<pre style="margin:0; padding:0 ">// Copyright Luke Valenty (TinyFPGA project)</pre>
<pre style="margin:0; padding:0 ">// Licensed under the Apache License, Version 2.0, see LICENSE for details.</pre>
<pre style="margin:0; padding:0 ">// SPDX-License-Identifier: Apache-2.0</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">// USB Full Speed Non-Buffered Protocol Engine</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// Decodes low level USB link protocol from external usb_fs_tx/rx</pre>
<pre style="margin:0; padding:0 ">// Provides upper level with</pre>
<pre style="margin:0; padding:0 ">// - OUT endpoint interface (host to device) which also covers SETUP</pre>
<pre style="margin:0; padding:0 ">// - IN endpoint interface (device to host)</pre>
<pre style="margin:0; padding:0 ">// - Start of Frame interface</pre>
<pre style="margin:0; padding:0 ">//</pre>
<pre style="margin:0; padding:0 ">// Based on usb_fs_pe.v from the TinyFPGA-Bootloader project but</pre>
<pre style="margin:0; padding:0 ">// this version contains no packet buffers</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">module usb_fs_nb_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter int unsigned NumOutEps = 2,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter int unsigned NumInEps = 2,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter int unsigned MaxPktSizeByte = 32,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  parameter int unsigned PktW = $clog2(MaxPktSizeByte)</pre>
<pre style="margin:0; padding:0 ">) (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   clk_48mhz_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   rst_ni,        // Async. reset, active low</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   link_reset_i,  // USB reset, sync to 48 MHz, active high</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [6:0]             dev_addr_i,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   cfg_eop_single_bit_i, // 1: detect a single SE0 bit as EOP</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   tx_osc_test_mode_i, // Oscillator test mode (constantly output JK)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumOutEps-1:0]   data_toggle_clear_i, // Clear the data toggles for an EP</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  ////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  // USB Endpoint Interface //</pre>
<pre style="margin:0; padding:0 ">  ////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  ///////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  // global endpoint interface //</pre>
<pre style="margin:0; padding:0 ">  ///////////////////////////////</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // out endpoint interfaces</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [3:0]             out_ep_current_o, // Other signals address to this ep</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   out_ep_data_put_o, // put the data (put addr advances after)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [PktW - 1:0]      out_ep_put_addr_o, // Offset to put data (0..pktlen)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [7:0]             out_ep_data_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   out_ep_newpkt_o,// New OUT pkt start (with in_ep_current_o update)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   out_ep_acked_o, // good termination, device has acked</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   out_ep_rollback_o, // bad termination, discard data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [NumOutEps-1:0]   out_ep_setup_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumOutEps-1:0]   out_ep_full_i, // Cannot accept data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumOutEps-1:0]   out_ep_stall_i, // Stalled</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumOutEps-1:0]   out_ep_iso_i, // Configure endpoint in isochronous mode</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // in endpoint interfaces</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [3:0]             in_ep_current_o, // Other signals addressed to this ep</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   in_ep_rollback_o, // Bad termination, rollback transaction</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   in_ep_acked_o, // good termination, transaction complete</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [PktW - 1:0]      in_ep_get_addr_o, // Offset requested (0..pktlen)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   in_ep_data_get_o, // Accept data (get_addr advances too)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   in_ep_newpkt_o, // New IN pkt start (with in_ep_current_o update)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumInEps-1:0]    in_ep_stall_i, // Endpoint in a stall state</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumInEps-1:0]    in_ep_has_data_i, // Endpoint has data to supply</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [7:0]             in_ep_data_i, // Data for current get_addr</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic [NumInEps-1:0]    in_ep_data_done_i, // Set when out of data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic  [NumInEps-1:0]   in_ep_iso_i, // Configure endpoint in isochronous mode</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // sof interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   sof_valid_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic [10:0]            frame_index_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // RX errors</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   rx_crc_err_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   rx_pid_err_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   rx_bitstuff_err_o,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  ///////////////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  // USB TX/RX Interface (synchronous) //</pre>
<pre style="margin:0; padding:0 ">  ///////////////////////////////////////</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   usb_d_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  input  logic                   usb_se0_i,</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   usb_d_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   usb_se0_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  output logic                   usb_oe_o</pre>
<pre style="margin:0; padding:0 ">);</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  import usb_consts_pkg::*;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // rx interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic bit_strobe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rx_pkt_end;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] rx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [6:0] rx_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] rx_endp;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [10:0] rx_frame_num;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rx_data_put;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [7:0] rx_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic rx_pkt_valid;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // tx mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic in_tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] in_tx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic out_tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] out_tx_pid;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // tx interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic tx_pkt_end;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [3:0] tx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic tx_data_avail;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic tx_data_get;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic [7:0] tx_data;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  logic usb_oe;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">  // sof interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign sof_valid_o = rx_pkt_end & rx_pkt_valid & (usb_pid_e'(rx_pid) == UsbPidSof);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign frame_index_o = rx_frame_num;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  assign usb_oe_o = usb_oe;</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  usb_fs_nb_in_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .NumInEps           (NumInEps),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .MaxInPktSizeByte   (MaxPktSizeByte)</pre>
<pre id="id123" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_usb_fs_nb_in_pe (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_48mhz_i           (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .link_reset_i          (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dev_addr_i            (dev_addr_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // endpoint interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_current_o       (in_ep_current_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_rollback_o      (in_ep_rollback_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_acked_o         (in_ep_acked_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_get_addr_o      (in_ep_get_addr_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_data_get_o      (in_ep_data_get_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_newpkt_o        (in_ep_newpkt_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_stall_i         (in_ep_stall_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_has_data_i      (in_ep_has_data_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_data_i          (in_ep_data_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_data_done_i     (in_ep_data_done_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_ep_iso_i           (in_ep_iso_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_toggle_clear_i   (data_toggle_clear_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // rx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_start_i        (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_end_i          (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_valid_i        (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pid_i              (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_addr_i             (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_endp_i             (rx_endp),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // tx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pkt_start_o        (in_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pkt_end_i          (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pid_o              (in_tx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_avail_o       (tx_data_avail),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_get_i         (tx_data_get),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_o             (tx_data)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  usb_fs_nb_out_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .NumOutEps           (NumOutEps),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .MaxOutPktSizeByte   (MaxPktSizeByte)</pre>
<pre id="id164" style="background-color: #FFB6C1; margin:0; padding:0 ">  ) u_usb_fs_nb_out_pe (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_48mhz_i            (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .dev_addr_i             (dev_addr_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // endpoint interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_current_o       (out_ep_current_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_data_put_o      (out_ep_data_put_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_put_addr_o      (out_ep_put_addr_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_data_o          (out_ep_data_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_newpkt_o        (out_ep_newpkt_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_acked_o         (out_ep_acked_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_rollback_o      (out_ep_rollback_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_setup_o         (out_ep_setup_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_full_i          (out_ep_full_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_stall_i         (out_ep_stall_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_ep_iso_i           (out_ep_iso_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .data_toggle_clear_i    (data_toggle_clear_i),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // rx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_start_i         (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_end_i           (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pkt_valid_i         (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_pid_i               (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_addr_i              (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_endp_i              (rx_endp),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_data_put_i          (rx_data_put),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_data_i              (rx_data),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // tx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pkt_start_o         (out_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pkt_end_i           (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pid_o               (out_tx_pid)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  usb_fs_rx u_usb_fs_rx (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i                  (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .cfg_eop_single_bit_i   (cfg_eop_single_bit_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .usb_d_i                (usb_d_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .usb_se0_i              (usb_se0_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_en_i                (usb_oe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bit_strobe_o           (bit_strobe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pkt_start_o            (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pkt_end_o              (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pid_o                  (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .addr_o                 (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .endp_o                 (rx_endp),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .frame_num_o            (rx_frame_num),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_data_put_o          (rx_data_put),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rx_data_o              (rx_data),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .valid_packet_o         (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .crc_error_o            (rx_crc_err_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pid_error_o            (rx_pid_err_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bitstuff_error_o       (rx_bitstuff_err_o)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  usb_fs_tx_mux u_usb_fs_tx_mux (</pre>
<pre style="margin:0; padding:0 ">    // interface to IN Protocol Engine</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_tx_pkt_start_i  (in_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .in_tx_pid_i        (in_tx_pid),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // interface to OUT Protocol Engine</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_tx_pkt_start_i (out_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .out_tx_pid_i       (out_tx_pid),</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="margin:0; padding:0 ">    // interface to tx module</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pkt_start_o     (tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_pid_o           (tx_pid)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 "></pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  usb_fs_tx u_usb_fs_tx (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .clk_i                  (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_osc_test_mode_i     (tx_osc_test_mode_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .bit_strobe_i           (bit_strobe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .usb_d_o                (usb_d_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .usb_se0_o              (usb_se0_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .usb_oe_o               (usb_oe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pkt_start_i            (tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pkt_end_o              (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .pid_i                  (tx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_avail_i        (tx_data_avail),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_get_o          (tx_data_get),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">    .tx_data_i              (tx_data)</pre>
<pre style="margin:0; padding:0 ">  );</pre>
<pre style="margin:0; padding:0 ">endmodule</pre>
<pre style="margin:0; padding:0 "></pre>
</body>
</html>
